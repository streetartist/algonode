{
  "last_node_id": 16,
  "last_link_id": 19,
  "nodes": [
    {
      "id": 1,
      "type": "data/load_csv",
      "pos": [50, 100],
      "size": [220, 120],
      "title": "Load Standardized Data",
      "properties": {
        "path": "D:/algonode/user_project/Risk Assessment Based on the Coupling of Public Health Disaster Hazard and Urban Vulnerability/数据标准化.csv",
        "header": 0,
        "encoding": "utf-8",
        "output_format": "dataframe"
      },
      "outputs": [
        {"name": "data", "type": "dataframe", "links": [1]}
      ]
    },
    {
      "id": 2,
      "type": "data/load_csv",
      "pos": [50, 280],
      "size": [220, 120],
      "title": "Load COVID Cases",
      "properties": {
        "path": "D:/algonode/user_project/Risk Assessment Based on the Coupling of Public Health Disaster Hazard and Urban Vulnerability/确诊病例.csv",
        "header": 0,
        "encoding": "utf-8",
        "output_format": "dataframe"
      },
      "outputs": [
        {"name": "data", "type": "dataframe", "links": [2]}
      ]
    },
    {
      "id": 3,
      "type": "data/filter_rows",
      "pos": [320, 100],
      "size": [200, 100],
      "title": "Filter Data Rows",
      "properties": {
        "condition": "index >= 3",
        "reset_index": true,
        "output_format": "dataframe"
      },
      "inputs": [
        {"name": "data", "type": "dataframe", "link": 1}
      ],
      "outputs": [
        {"name": "filtered", "type": "dataframe", "links": [3]}
      ]
    },
    {
      "id": 4,
      "type": "data/select_column",
      "pos": [320, 280],
      "size": [200, 80],
      "title": "Extract COVID Cases",
      "properties": {
        "selector": "新增确诊病例+无症状感染",
        "mode": "name",
        "as_array": true
      },
      "inputs": [
        {"name": "data", "type": "dataframe", "link": 2}
      ],
      "outputs": [
        {"name": "column", "type": "array", "links": [4]}
      ]
    },
    {
      "id": 5,
      "type": "data/weighted_score",
      "pos": [570, 50],
      "size": [280, 150],
      "title": "Calculate Hazard Score (U1)",
      "properties": {
        "indicators": "65岁及以上人口比例:P:1,贫困人口:P:1,人口密度:P:1,就业密度:P:1,国内游客到达人数:P:1,每万人公共汽车（和无轨电车）数量:P:1,公路客运交通量:P:1,PM2.5浓度:P:1,相对湿度:P:1,平均温度:N:1",
        "normalize": "minmax",
        "add_normalized_cols": false,
        "score_column": "U1_Hazard",
        "output_format": "dataframe"
      },
      "inputs": [
        {"name": "data", "type": "dataframe", "link": 3}
      ],
      "outputs": [
        {"name": "result", "type": "dataframe", "links": [5]}
      ]
    },
    {
      "id": 6,
      "type": "data/weighted_score",
      "pos": [900, 50],
      "size": [280, 150],
      "title": "Calculate Vulnerability Score (U2)",
      "properties": {
        "indicators": "居住密度:N:1,日常生活服务设施密度:P:1,交通设施密度:P:1,建成区绿化覆盖率:N:1,开放空间密度:N:1,失业率:P:1,人均收入:N:1,健康支出占GDP的百分比:N:1,每位居民年平均储蓄存款余额:N:1,应急物资储备支出占GDP的比例（%）（每万元）:N:1,每万人医生数量:N:1,每万人医院床位数:N:1,基本社会保险覆盖率:N:1",
        "normalize": "minmax",
        "add_normalized_cols": false,
        "score_column": "U2_Vulnerability",
        "output_format": "dataframe"
      },
      "inputs": [
        {"name": "data", "type": "dataframe", "link": 5}
      ],
      "outputs": [
        {"name": "result", "type": "dataframe", "links": [6, 7]}
      ]
    },
    {
      "id": 7,
      "type": "data/select_column",
      "pos": [1230, 50],
      "size": [200, 80],
      "title": "Extract U1",
      "properties": {
        "selector": "U1_Hazard",
        "mode": "name",
        "as_array": true
      },
      "inputs": [
        {"name": "data", "type": "dataframe", "link": 6}
      ],
      "outputs": [
        {"name": "column", "type": "array", "links": [8]}
      ]
    },
    {
      "id": 8,
      "type": "data/select_column",
      "pos": [1230, 160],
      "size": [200, 80],
      "title": "Extract U2",
      "properties": {
        "selector": "U2_Vulnerability",
        "mode": "name",
        "as_array": true
      },
      "inputs": [
        {"name": "data", "type": "dataframe", "link": 7}
      ],
      "outputs": [
        {"name": "column", "type": "array", "links": [9]}
      ]
    },
    {
      "id": 9,
      "type": "data/select_column",
      "pos": [570, 250],
      "size": [200, 80],
      "title": "Extract City Names",
      "properties": {
        "selector": "编号",
        "mode": "name",
        "as_array": true
      },
      "inputs": [
        {"name": "data", "type": "dataframe", "link": 3}
      ],
      "outputs": [
        {"name": "column", "type": "array", "links": [10]}
      ]
    },
    {
      "id": 10,
      "type": "custom/python_script",
      "pos": [1480, 100],
      "size": [380, 400],
      "title": "Model Validation & Correlation Analysis",
      "properties": {
        "code": "import numpy as np\nfrom scipy import stats\n\n# Normalize U1 and U2 to [0,1]\nu1_norm = (U1 - np.min(U1)) / (np.max(U1) - np.min(U1) + 1e-10)\nu2_norm = (U2 - np.min(U2)) / (np.max(U2) - np.min(U2) + 1e-10)\n\n# Coupling degree C = 2 * sqrt(U1*U2) / (U1+U2)\nC = 2 * np.sqrt(u1_norm * u2_norm) / (u1_norm + u2_norm + 1e-10)\n\n# Comprehensive index T = alpha*U1 + (1-alpha)*U2\nalpha = 0.5\nT = alpha * u1_norm + (1 - alpha) * u2_norm\n\n# Coupling coordination degree D = sqrt(C * T)\nD = np.sqrt(C * T)\n\n# Risk Index R = U1 * U2\nR = u1_norm * u2_norm\n\n# Normalize COVID cases for comparison\ncases = np.array(covid_cases, dtype=float)\ncases_norm = (cases - np.min(cases)) / (np.max(cases) - np.min(cases) + 1e-10)\n\n# Correlation Analysis\n# Pearson correlation between D and actual cases\ncorr_D_cases, p_D = stats.pearsonr(D, cases_norm)\n\n# Pearson correlation between R and actual cases\ncorr_R_cases, p_R = stats.pearsonr(R, cases_norm)\n\n# Spearman rank correlation (more robust)\nspearman_D, sp_p_D = stats.spearmanr(D, cases_norm)\nspearman_R, sp_p_R = stats.spearmanr(R, cases_norm)\n\n# Traditional model comparison\nR_trad = (u1_norm + u2_norm) / 2\ncorr_trad, p_trad = stats.pearsonr(R_trad, cases_norm)\nspearman_trad, sp_p_trad = stats.spearmanr(R_trad, cases_norm)\n\n# Model validation metrics\nvalidation_results = {\n    'Coupling_D_Pearson': float(corr_D_cases),\n    'Coupling_D_Spearman': float(spearman_D),\n    'Risk_R_Pearson': float(corr_R_cases),\n    'Risk_R_Spearman': float(spearman_R),\n    'Traditional_Pearson': float(corr_trad),\n    'Traditional_Spearman': float(spearman_trad)\n}\n\n# Convert to output arrays\ncorr_D_pearson = float(corr_D_cases)\ncorr_D_spearman = float(spearman_D)\ncorr_R_pearson = float(corr_R_cases)\ncorr_trad_pearson = float(corr_trad)\n\n# Determine model superiority\nif abs(corr_D_cases) > abs(corr_trad):\n    model_superior = 'Coupling model is superior'\nelse:\n    model_superior = 'Traditional model is superior'\n\n# Prepare data for scatter plot\nD_output = D\ncases_output = cases_norm",
        "inputs": "U1,U2,covid_cases",
        "outputs": "D_output,cases_output,corr_D_pearson,corr_D_spearman,corr_R_pearson,corr_trad_pearson,model_superior"
      },
      "inputs": [
        {"name": "U1", "type": "array", "link": 8},
        {"name": "U2", "type": "array", "link": 9},
        {"name": "covid_cases", "type": "array", "link": 4}
      ],
      "outputs": [
        {"name": "D_output", "type": "array", "links": [11, 15]},
        {"name": "cases_output", "type": "array", "links": [12, 16]},
        {"name": "corr_D_pearson", "type": "number", "links": [13]},
        {"name": "corr_D_spearman", "type": "number", "links": [17]},
        {"name": "corr_R_pearson", "type": "number", "links": [18]},
        {"name": "corr_trad_pearson", "type": "number", "links": [19]},
        {"name": "model_superior", "type": "string", "links": [14]}
      ]
    },
    {
      "id": 11,
      "type": "io/output",
      "pos": [1920, 50],
      "size": [180, 60],
      "title": "D Pearson Correlation",
      "properties": {
        "name": "correlation_D_pearson"
      },
      "inputs": [
        {"name": "value", "type": "any", "link": 13}
      ]
    },
    {
      "id": 12,
      "type": "io/output",
      "pos": [1920, 130],
      "size": [180, 60],
      "title": "D Spearman Correlation",
      "properties": {
        "name": "correlation_D_spearman"
      },
      "inputs": [
        {"name": "value", "type": "any", "link": 17}
      ]
    },
    {
      "id": 13,
      "type": "io/output",
      "pos": [1920, 210],
      "size": [180, 60],
      "title": "R Pearson Correlation",
      "properties": {
        "name": "correlation_R_pearson"
      },
      "inputs": [
        {"name": "value", "type": "any", "link": 18}
      ]
    },
    {
      "id": 14,
      "type": "io/output",
      "pos": [1920, 290],
      "size": [180, 60],
      "title": "Traditional Correlation",
      "properties": {
        "name": "correlation_traditional"
      },
      "inputs": [
        {"name": "value", "type": "any", "link": 19}
      ]
    },
    {
      "id": 15,
      "type": "io/output",
      "pos": [1920, 370],
      "size": [180, 60],
      "title": "Model Superiority",
      "properties": {
        "name": "model_validation_result"
      },
      "inputs": [
        {"name": "value", "type": "any", "link": 14}
      ]
    },
    {
      "id": 16,
      "type": "viz/plot_scatter",
      "pos": [1920, 450],
      "size": [200, 100],
      "title": "D vs COVID Cases",
      "properties": {
        "title": "Coupling Coordination (D) vs Normalized COVID Cases",
        "xlabel": "Coupling Coordination Degree (D)",
        "ylabel": "Normalized COVID Cases"
      },
      "inputs": [
        {"name": "X", "type": "array", "link": 15},
        {"name": "Y", "type": "array", "link": 16}
      ]
    }
  ],
  "links": [
    [1, 1, 0, 3, 0, "dataframe"],
    [2, 2, 0, 4, 0, "dataframe"],
    [3, 3, 0, 5, 0, "dataframe"],
    [4, 4, 0, 10, 2, "array"],
    [5, 5, 0, 6, 0, "dataframe"],
    [6, 6, 0, 7, 0, "dataframe"],
    [7, 6, 0, 8, 0, "dataframe"],
    [8, 7, 0, 10, 0, "array"],
    [9, 8, 0, 10, 1, "array"],
    [10, 3, 0, 9, 0, "dataframe"],
    [11, 10, 0, 16, 0, "array"],
    [12, 10, 1, 16, 1, "array"],
    [13, 10, 2, 11, 0, "number"],
    [14, 10, 6, 15, 0, "string"],
    [15, 10, 0, 16, 0, "array"],
    [16, 10, 1, 16, 1, "array"],
    [17, 10, 3, 12, 0, "number"],
    [18, 10, 4, 13, 0, "number"],
    [19, 10, 5, 14, 0, "number"]
  ],
  "groups": [
    {
      "title": "Task 3: Model Validation with Actual COVID-19 Data",
      "bounding": [30, 30, 2200, 600],
      "color": "#98fb98"
    }
  ],
  "config": {},
  "extra": {
    "description": "Task 3: Validate the coupling coordination model using actual COVID-19 case data from 18 cities",
    "author": "AlgoNode",
    "version": "1.0",
    "validation_metrics": {
      "pearson_correlation": "Measures linear relationship between model predictions and actual cases",
      "spearman_correlation": "Measures monotonic relationship (rank-based, more robust)",
      "model_comparison": "Compares coupling model vs traditional additive model"
    },
    "interpretation": {
      "positive_correlation": "Higher D/R values correspond to more COVID cases (model validated)",
      "significance": "p-value < 0.05 indicates statistically significant correlation"
    }
  }
}
